import React, { useState, useEffect } from 'react'
import moment from 'moment'

import { Typography } from '@mui/material'
import CreditScoreIcon from '@mui/icons-material/CreditScore'
import LocalShippingIcon from '@mui/icons-material/LocalShipping'

const OrderHeader = (props) => {
  const { id, bankAccount, order } = props

  let [currentTime, setCurrentTime] = useState('')
  let createdAt = order?.createdAt // ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Redux (createdAt)
  const threeDaysInMs = 3 * 24 * 60 * 60 * 1000 // 3 ‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏°‡∏¥‡∏•‡∏•‡∏¥‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ

  useEffect(() => {
    if (createdAt) {
      const startDate = moment(createdAt) // ‡πÅ‡∏õ‡∏•‡∏á createdAt ‡πÄ‡∏õ‡πá‡∏ô moment object

      const intervalId = setInterval(() => {
        const now = moment()
        setCurrentTime(now.format('D MMMM YYYY, h:mm:ss a'))

        //TODO: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏•‡∏¢ 3 ‡∏ß‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
        // if (now.diff(startDate) >= threeDaysInMs) {
        //   handleThreeDaysPassed()
        //   clearInterval(intervalId) // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏ö 3 ‡∏ß‡∏±‡∏ô
        // }
      }, 1000)

      return () => clearInterval(intervalId)
    }
  }, [createdAt])

  const handleThreeDaysPassed = () => {
    toast.error('‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡∏ß‡∏±‡∏ô!')
    console.log('‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡∏ß‡∏±‡∏ô')
    // ‡πÉ‡∏™‡πà‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏ö 3 ‡∏ß‡∏±‡∏ô
  }

  return (
    <>
      <Typography variant="h4">
        <span className="text-success ms-2 text-center">
          ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì {order.name}
          {order.complete && (
            <>
              <span className="mt-3 text-success">
                &nbsp;
                <CreditScoreIcon /> ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
              </span>
              {order.sended && (
                <>
                  <span className="mt-3 text-warning">
                    &nbsp;
                    <LocalShippingIcon /> ‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß
                  </span>
                </>
              )}
            </>
          )}
        </span>
      </Typography>

      <div className="card shadow">
        <div className="text-center">
          <br />
          <p>
            <code>**</code>‡πÇ‡∏õ‡∏£‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 3 ‡∏ß‡∏±‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ 72 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
            <code>**</code>
            <br />
            ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏°‡∏î
            ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ô‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Pre-Order ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡πà‡∏≤‡∏ä‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 7 - 14 ‡∏ß‡∏±‡∏ô
          </p>
          <p>{currentTime}</p>
          Order :
          <span className="text-danger">
            <strong>#{id}</strong>
          </span>
          <br />
          {bankAccount &&
            bankAccount.map((b) => (
              <React.Fragment key={b.id}>
                --------------------------------------------
                <br />
                ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ {b.bank} ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ {b.bankID}
                <br />
                ‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ {b.bankName}
                <br />
                <br />
                {b.qrCode ? (
                  <div className="text-center">
                    <img
                      src={b.qrCode}
                      alt="PromptPay"
                      style={{
                        height: '300px', // ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô
                        objectFit: 'cover', // ‡∏õ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                      }}
                    />
                  </div>
                ) : (
                  `‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå ${b.promptPay}`
                )}
                --------------------------------------------
              </React.Fragment>
            ))}
          <br />
          üôè ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏Ç‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ üí¢ ‡πÇ‡∏≠‡∏ô‡∏¢‡∏≠‡∏î‡∏ö‡∏¥‡∏•‡∏ï‡πà‡∏≠‡∏ö‡∏¥‡∏•‡∏ô‡∏∞‡∏Ñ‡∏∞
          ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏≠‡∏ü‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞üí¢
          <br /> üí¢‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡∏´‡∏±‡∏Å‡∏•‡∏ö‡∏¢‡∏≠‡∏î‡πÄ‡∏≠‡∏á ‡πÇ‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏∞
          ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏¢‡∏≠‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏Ñ‡πà‡∏∞üôè
          <br /> üôè ‡∏ñ‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ï‡∏≥‡∏´‡∏ô‡∏¥‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏µ‡∏ö‡πÅ‡∏à‡πâ‡∏á ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô
          ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ï‡∏≥‡∏´‡∏ô‡∏¥‡∏à‡∏≤‡∏Å‡∏£‡πâ‡∏≤‡∏ô ‡∏™‡πà‡∏á‡∏ú‡∏¥‡∏î‡∏™‡∏µ‡∏ú‡∏¥‡∏î‡πÅ‡∏ö‡∏ö ‡∏ú‡∏¥‡∏î‡πÑ‡∏ã‡∏™‡πå ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏∞
          ‡∏Ç‡∏≠‡∏ö‡∏û‡∏£‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏Å‡∏Ñ‡∏∞üôè
          <br />
          <br />
        </div>
      </div>
    </>
  )
}
export default OrderHeader
